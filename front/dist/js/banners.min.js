function Bannerimgeidt(){this.bannerbox=template("card-box",{})}Bannerimgeidt.prototype.run=function(){this.banneraddevent(),this.bannerboxdelete()},Bannerimgeidt.prototype.banneraddevent=function(){var t=this;$("#box-add").click(function(){var n=$("#content-box");n.prepend(t.bannerbox),t.bannerboxdelete();var e=n.find(".box-c:first");t.imageClickEvent(e),t.bannercommitEvent(e)})},Bannerimgeidt.prototype.bannerboxdelete=function(){$(".del-btn").click(function(){console.log("success");var e=$(this).parent().parent(),t=e.attr("data-boxid");t?swal({title:"确定删除吗？",text:"你将删除这张轮播图！",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确定删除！",cancelButtonText:"取消删除！",closeOnConfirm:!1,closeOnCancel:!0},function(n){n&&bufanajax.post({url:"/cms/banner_delete/",data:{banners_id:t},success:function(n){200===n.code&&(swal("删除！","轮播图已删除","success"),e.remove())},fail:function(n){swal("错误",n.message)}})}):e.remove()})},Bannerimgeidt.prototype.bannercommitEvent=function(n){var e=n.find(".commit-btn"),o=n.find(".thumbnail"),a=n.find('input[name="position"]'),i=n.find('input[name="link_to"]');e.click(function(){var n=o.attr("src"),e=a.val(),t=i.val();console.log(n,e,t),console.log("success into commit-btn"),bufanajax.post({url:"/cms/banner/",data:{bannersimg:n,position:e,link_to:t},success:function(n){console.log(n),200===n.code?(swal("成功","添加轮播图成功"),window.location.reload()):swal("失败",n.data)}})})},Bannerimgeidt.prototype.imageClickEvent=function(e){var t=e.find(".thumbnail");t.click(function(){console.log("click event");var n=e.find(".thumbnailinput");n.click(),n.change(function(){console.log("change event");var n=this.files[0],e=new FormData;e.append("file",n),console.log(n),n&&bufanajax.post({url:"/cms/upload/",dataType:"json",processData:!1,contentType:!1,data:e,success:function(n){console.log(n);var e=n.data.file_url;t.attr({src:e})},fail:function(n){console.log(n)}})})})},$(function(){(new Bannerimgeidt).run()});